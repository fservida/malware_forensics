# Project: vol_plugins
# Filename: json_format.py
# Created on 27.11.17 by francesco
# Last modified on 27.11.17 by francesco

import json
import sys

if __name__ == '__main__':
    n_args = len(sys.argv)
    if n_args == 1:
        print("Please specify path of json output of malfinder, apihooks or vadinfo")
    elif n_args == 2:
        json_path = sys.argv[1]
        with open(json_path) as input_json:

            with open(json_path+"_formatted.json", "w") as output_json:
                json.dump(json.load(input_json), output_json, indent=4)
    else:
        print("Wrong number of parameters specified")